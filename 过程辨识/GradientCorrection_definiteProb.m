%% 脉冲响应辨识（确定性情形）
%% 输入输出数据（来自表 7.1）
u = [-1 -1 -1 -1  1  1  1 -1  1  1 -1 -1  1 -1  1 -1 -1 -1 -1  1]';
y = [ 0 -2 -6 -7 -7 -3  5  7  3 -1  5  3 -5 -3  1 -1  1 -5 -7 -7]';

N = 3;                  % 脉冲响应长度
L = length(y);

%% 回归矩阵
Phi = [];
Y   = [];

for k = N+1:L
    Phi = [Phi;
           u(k-1) u(k-2) u(k-3)];
    Y   = [Y;
           y(k)];
end

%% 最小二乘估计（确定性问题）
g_hat = (Phi' * Phi) \ (Phi' * Y);

%% 输出结果
fprintf('估计的脉冲响应参数：\n');
fprintf('g1 = %.4f\n', g_hat(1));
fprintf('g2 = %.4f\n', g_hat(2));
fprintf('g3 = %.4f\n', g_hat(3));
